<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forensic Graph: Elton-2 Full Investigation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/standalone/umd/vis-network.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #000; color: #fff; margin: 0; }
        #network-container { width: 100%; height: calc(100vh - 64px); background-color: #000; }
        .vis-network:focus { outline: none; }
        
        .vercel-panel {
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid #222;
        }

        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #000; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }

        .nav-btn {
            font-size: 10px; font-weight: 700; color: #555;
            text-transform: uppercase; letter-spacing: 0.1em;
            padding: 8px 12px; transition: 0.2s;
        }
        .nav-btn:hover { color: #fff; }
        .active-btn { color: #fff !important; border-bottom: 1px solid #fff; }
    </style>
</head>
<body class="overflow-hidden">

    <header class="h-16 border-b border-zinc-800 flex items-center justify-between px-6 bg-black z-30 relative">
        <div class="flex items-center space-x-6">
            <div class="flex items-center space-x-2">
                <svg width="20" height="20" viewBox="0 0 76 65" fill="#fff"><path d="M37.5274 0L75.0548 65H0L37.5274 0Z"></path></svg>
                <span class="text-xs font-bold tracking-widest uppercase italic">Forensic Intelligence Map</span>
            </div>
            <div class="h-4 w-px bg-zinc-800"></div>
            <nav class="flex space-x-1">
                <button onclick="applyFilter('profit')" class="nav-btn">üí∞ –í—ã—Ä—É—á–∫–∞</button>
                <button onclick="applyFilter('offshore')" class="nav-btn">üåç –û—Ñ—à–æ—Ä—ã</button>
                <button onclick="applyFilter('empire')" class="nav-btn">üè∞ –ò–º–ø–µ—Ä–∏—è</button>
                <button onclick="applyFilter('nko')" class="nav-btn">üõ°Ô∏è –•–∞–±—ã/–ù–ö–û</button>
                <button onclick="applyFilter('transit')" class="nav-btn">üîÑ –û–±–Ω–∞–ª/–¢—Ä–∞–Ω–∑–∏—Ç</button>
                <button onclick="applyFilter('record')" class="nav-btn">üìà –£–ö –†–µ–∫–æ—Ä–¥</button>
            </nav>
        </div>
        
        <div class="flex items-center space-x-4">
            <input type="text" id="node-search" placeholder="–ü–æ–∏—Å–∫ (–§–ò–û, –ò–ù–ù, –î–∏—Ä–µ–∫—Ç–æ—Ä)..." 
                class="bg-zinc-950 border border-zinc-800 rounded px-4 py-2 text-xs text-white focus:border-zinc-500 outline-none w-72 transition-all">
            <button onclick="resetView()" class="bg-white text-black px-4 py-2 rounded text-[10px] font-bold uppercase hover:bg-zinc-200">–°–±—Ä–æ—Å</button>
        </div>
    </header>

    <main class="relative">
        <div id="network-container"></div>

        <!-- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å: –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç—á–µ—Ç -->
        <div id="analytic-report" class="absolute top-6 left-6 w-96 vercel-panel p-6 hidden z-40 rounded-lg">
            <div class="flex justify-between items-start mb-4">
                <h3 id="report-title" class="text-[10px] font-bold text-white uppercase tracking-widest"></h3>
                <button onclick="closeReport()" class="text-zinc-500 hover:text-white">&times;</button>
            </div>
            <p id="report-text" class="text-xs text-zinc-400 leading-relaxed mb-4 font-light"></p>
            <div id="report-nodes" class="space-y-1.5 max-h-64 overflow-y-auto custom-scrollbar pr-2"></div>
        </div>

        <!-- –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å: –ö–∞—Ä—Ç–æ—á–∫–∞ –æ–±—ä–µ–∫—Ç–∞ -->
        <div id="info-sidebar" class="absolute top-6 right-6 w-96 vercel-panel hidden z-40 rounded-lg flex flex-col max-h-[85vh] overflow-hidden">
            <div class="p-6 border-b border-zinc-800 flex justify-between items-start">
                <div id="sidebar-header"></div>
                <button onclick="closeSidebar()" class="text-zinc-600 hover:text-white text-xl">&times;</button>
            </div>
            <div id="info-content" class="p-6 overflow-y-auto custom-scrollbar flex-1 font-light text-zinc-400 text-sm leading-relaxed"></div>
        </div>
    </main>

    <script>
        // –ü–û–õ–ù–´–ô –ú–ê–°–°–ò–í –î–ê–ù–ù–´–• –ò–ó –¢–í–û–ï–ì–û –ò–°–°–õ–ï–î–û–í–ê–ù–ò–Ø
        const rawNodes = [
            // --- –¶–ï–ù–¢–†–ê–õ–¨–ù–´–ô –£–ó–ï–õ ---
            { id: 'SE2', label: '–û–û–û –°–∞–Ω–∞—Ç–æ—Ä–∏–π –≠–ª—å—Ç–æ–Ω-2', group: 'bankrupt', info: '–î–û–õ–ñ–ù–ò–ö. –ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä –º–ª—Ä–¥ –¥–æ–ª–≥–æ–≤. –ë–µ–Ω–µ—Ñ–∏—Ü–∏–∞—Ä—ã: –ß—É–≥—É–Ω–æ–≤ –õ.–°. (85%), –ú–∏—Ö–µ–µ–≤ –°.–ò. (15%).', pattern: 'core' },
            { id: 'KHAR', label: '–•–∞—Ä—á–µ–Ω–∫–æ –°. –í.', group: 'official', info: '–ö–æ–Ω–∫—É—Ä—Å–Ω—ã–π —É–ø—Ä–∞–≤–ª—è—é—â–∏–π. –í–∑—ã—Å–∫–∞–Ω–∏–µ —É–±—ã—Ç–∫–æ–≤ —Å –≠–ª—å—Ç–æ–Ω-–ú–µ–¥ (42.1 –º–ª–Ω —Ä—É–±).', pattern: 'core' },

            // --- –ö–ê–ù–ê–õ 1: –í–´–†–£–ß–ö–ê ---
            { id: 'EM', label: '–û–û–û –≠–ª—å—Ç–æ–Ω-–ú–µ–¥', group: 'company', info: '–ö–æ–º–ø–∞–Ω–∏—è-–ø—ã–ª–µ—Å–æ—Å. –ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å 2024: 80.7 –º–ª–Ω —Ä—É–±. –ê–∫–∫—É–º—É–ª–∏—Ä—É–µ—Ç –¥–æ—Ö–æ–¥—ã —Å–∞–Ω–∞—Ç–æ—Ä–∏—è.', pattern: 'profit' },
            { id: 'CH_L', label: '–ß—É–≥—É–Ω–æ–≤ –õ. –°.', group: 'person', info: '–ú–∞–∂–æ—Ä–∏—Ç–∞—Ä–Ω—ã–π —É—á—Ä–µ–¥–∏—Ç–µ–ª—å (85%) –¥–æ–ª–∂–Ω–∏–∫–∞. –ì–µ–Ω–¥–∏—Ä–µ–∫—Ç–æ—Ä –≠–ª—å—Ç–æ–Ω-–ú–µ–¥.', pattern: 'empire' },
            { id: 'BA_I', label: '–ë–∞–≥—Ä–æ–≤–∞ –ò. –ê.', group: 'person', info: '–°—É–ø—Ä—É–≥–∞ –ß—É–≥—É–Ω–æ–≤–∞ –õ.–°. –¢–µ–∫—É—â–∏–π –Ω–æ–º–∏–Ω–∞–ª—å–Ω—ã–π —É—á—Ä–µ–¥–∏—Ç–µ–ª—å –≠–ª—å—Ç–æ–Ω-–ú–µ–¥ (100%).', pattern: 'profit' },
            { id: 'CH_A_P', label: '–ß—É–≥—É–Ω–æ–≤ –ê. –í. (–ü–ª–µ–º—è–Ω–Ω–∏–∫)', group: 'person', info: '–ë—ã–≤—à–∏–π 100% –≤–ª–∞–¥–µ–ª–µ—Ü –≠–ª—å—Ç–æ–Ω-–ú–µ–¥. –í–ª–∞–¥–µ–ª–µ—Ü –æ—Ñ—à–æ—Ä–∞ Mobray Investments.', pattern: 'offshore' },
            { id: 'CONF', label: '–û–û–û –ö–æ–Ω—Ñ–µ—Ç—Ç–∏', group: 'company', info: '–°–≤—è–∑–∞–Ω–∞ —á–µ—Ä–µ–∑ –ë–∞–≥—Ä–æ–≤—É –ò.–ê.', pattern: 'profit' },
            { id: 'ALT', label: '–ê–ª—Ç—É—Ö–æ–≤ –î. –ù.', group: 'person', info: '–≠–∫—Å-–¥–∏—Ä–µ–∫—Ç–æ—Ä –≠–ª—å—Ç–æ–Ω-–ú–µ–¥. –°–≤—è–∑–∏: –û–û–û –ë–æ—Ä–∫–æ–≤–æ, –ë–∞—Ä—Ö–∞—Ç, –ì–ü–ö.', pattern: 'profit' },

            // --- –ö–ê–ù–ê–õ 2: –û–§–®–û–†–´ ---
            { id: 'MOBRAY', label: 'MOBRAY INVESTMENTS (–ö–∏–ø—Ä)', group: 'offshore', info: '–í–ª–∞–¥–µ–ª–µ—Ü: –ß—É–≥—É–Ω–æ–≤ –ê.–í. (100%). –î–∏—Ä–µ–∫—Ç–æ—Ä: –ü–∞–º–ø–∏–Ω–∞ –í–æ—Ç—Å–∏. –§–∏–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–π–º—ã.', pattern: 'offshore' },
            { id: 'FINWAY', label: 'FINWAY EXPORT (–ì–æ–Ω–∫–æ–Ω–≥)', group: 'offshore', info: '–î–∏—Ä–µ–∫—Ç–æ—Ä: –°—Ç—ç–Ω –ì–æ—Ä–∏–Ω. –§–∏–∫—Ç–∏–≤–Ω–∞—è –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å.', pattern: 'offshore' },
            { id: 'MARSTEEL', label: 'MARSTEEL CONSOLIDATED (–ë–í–û)', group: 'offshore', info: '–î–∏—Ä–µ–∫—Ç–æ—Ä: –í—Ä–∞—Ö–∏–º–∏—Å –°–∫–æ—Ä–¥–∏. –£—á–∞—Å—Ç–∏–µ –≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —É–±—ã—Ç–∫–æ–≤.', pattern: 'offshore' },
            { id: 'PEREYRA', label: 'PEREYRA LIMITED (–ë–í–û)', group: 'offshore', info: '–î–∏—Ä–µ–∫—Ç–æ—Ä: –•—Ä–∏—Å—Ç–∞–ª–ª–∞ –ú–µ–Ω–µ–ª–∞—É. –§–∏–∫—Ç–∏–≤–Ω—ã–π —Ü–µ—Å—Å–∏–æ–Ω–∞—Ä–∏–π.', pattern: 'offshore' },
            { id: 'KOL', label: '–ö–æ–ª–µ—Å–Ω–∏–∫–æ–≤ –ì. –í.', group: 'person', info: '–î–∏—Ä–µ–∫—Ç–æ—Ä –¥–æ–ª–∂–Ω–∏–∫–∞ —Å 2020 –≥. –ù–æ–º–∏–Ω–∞–ª-—Ç—Ä–∞–Ω–∑–∏—Ç–µ—Ä –¥–ª—è –æ—Ñ—à–æ—Ä–æ–≤.', pattern: 'offshore' },

            // --- –ö–ê–ù–ê–õ 3: –ò–ú–ü–ï–†–ò–Ø ---
            { id: 'NPZ', label: '–û–û–û –Æ–∂–Ω–æ—Ä—É—Å—Å–∫–∏–π –ù–ü–ó', group: 'company', info: '–ù–µ—Ñ—Ç—è–Ω–æ–π –±–∏–∑–Ω–µ—Å —Å–µ–º—å–∏. –ê–∫—Ü–∏–æ–Ω–µ—Ä—ã: –ó–∞—Ö–∞—Ä–æ–≤–∞ (66.8%), –ß—É–≥—É–Ω–æ–≤ (4.5%), –®–º–∞–ª—å (7.3%).', pattern: 'empire' },
            { id: 'PASS', label: '–ó–ê–û –ü–∞—Å—Å–∞–∂ –û–∫—Ç—è–±—Ä—å—Å–∫–æ–µ –ü–æ–ª–µ', group: 'company', info: '–ö–ª—é—á–µ–≤–æ–π —Ö–∞–± –ø–µ—Ä–µ–∫–∞—á–∫–∏ —Å—Ä–µ–¥—Å—Ç–≤ –≤ –ù–ö–û. –£—á—Ä–µ–¥–∏—Ç–µ–ª—å: –ß—É–≥—É–Ω–æ–≤ –õ.–°.', pattern: 'empire' },
            { id: 'REV', label: '–¢–°–ù –ò—Å—Ç—å–∏–Ω—Å–∫–∞—è –†–µ–≤—å–µ—Ä–∞', group: 'company', info: '–≠–ª–∏—Ç–Ω—ã–π –ø–æ—Å–µ–ª–æ–∫. –£—á—Ä–µ–¥–∏—Ç–µ–ª–∏: –ß—É–≥—É–Ω–æ–≤ –õ.–°., –ë–∞–∂–µ–Ω–æ–≤ –ê.–í.', pattern: 'empire' },
            { id: 'MED_SRV', label: '–ê–û –ö–î–¶ –ï–≤—Ä–æ–º–µ–¥—Å–µ—Ä–≤–∏—Å', group: 'company', pattern: 'empire' },
            { id: 'CSL', label: '–û–û–û –ß–µ—Ä–Ω–æ–º–æ—Ä—Å–∫–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–Ω—ã–µ –ª–∏–Ω–∏–∏', group: 'company', pattern: 'empire' },
            { id: 'SHMAL', label: '–®–º–∞–ª—å –ì. –ò.', group: 'person', info: '–°–≤—è–∑—å —Å –ê–û –ú–∏–Ω–Ω–µ—Ñ—Ç–µ–≥–∞–∑—Å—Ç—Ä–æ–π –∏ –û–û–û –≠–Ω–µ—Ä–¥–∂–∏ –ò–Ω–≤–µ—Å—Ç.', pattern: 'empire' },

            // --- –ö–ê–ù–ê–õ 4-5: –ù–ö–û –ò –•–ê–ë–´ ---
            { id: 'MEGAPIR', label: '–ê–°–°–û–¶–ò–ê–¶–ò–Ø –ú–ï–ì–ê–ü–ò–†', group: 'hub', info: '–ú–µ–≥–∞-—Ö–∞–±. –ì–µ–Ω–¥–∏—Ä–µ–∫—Ç–æ—Ä: –ö–∞–Ω—å—à–∏–Ω –ê.–ê. –†–∞—Å—Ç–≤–æ—Ä–µ–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤ –≤ —Ñ–æ–Ω–¥–∞—Ö.', pattern: 'nko' },
            { id: 'CHURCH', label: '–ü—Ä–∏—Ö–æ–¥ –•—Ä–∞–º–∞ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞ –ù–µ–≤—Å–∫–æ–≥–æ', group: 'hub', info: '–†–µ–ª–∏–≥–∏–æ–∑–Ω—ã–π —â–∏—Ç. –£—á—Ä–µ–¥–∏—Ç–µ–ª–∏: –ë–æ–≥–¥–∞–Ω–æ–≤, –ó–∞—Ö–∞—Ä–æ–≤–∞, –ö–∞–∑–∞–Ω–æ–≤.', pattern: 'nko' },
            { id: 'BOGD', label: '–ë–æ–≥–¥–∞–Ω–æ–≤ –ê. –í.', group: 'person', info: '–≠–∫—Å-–¥–∏—Ä–µ–∫—Ç–æ—Ä. –Ø–≤–∫–∞ —Å –ø–æ–≤–∏–Ω–Ω–æ–π –ø–æ —Ñ–∏–∫—Ç–∏–≤–Ω—ã–º –æ—Ñ—à–æ—Ä–Ω—ã–º –¥–æ–ª–≥–∞–º.', pattern: 'nko' },
            { id: 'ZAKH', label: '–ó–∞—Ö–∞—Ä–æ–≤–∞ –ï. –ê.', group: 'person', info: '–ù–æ–º–∏–Ω–∞–ª—å–Ω—ã–π –¥–∏—Ä–µ–∫—Ç–æ—Ä, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å –ù–ü–ó –∏ –•—Ä–∞–º–∞–º–∏.', pattern: 'nko' },
            { id: 'ROMANOV', label: '–ö–æ–º–∏—Ç–µ—Ç 400-–ª–µ—Ç–∏—è –î–æ–º–∞ –†–æ–º–∞–Ω–æ–≤—ã—Ö', group: 'hub', pattern: 'nko' },
            { id: 'IZUMRUD', label: '–¢–°–ñ –ò–∑—É–º—Ä—É–¥', group: 'hub', info: '–°–≤—è–∑–∞–Ω–æ —á–µ—Ä–µ–∑ –ë–æ–≥–¥–∞–Ω–æ–≤—É –í.–î.', pattern: 'nko' },
            { id: 'SOLDIER_H', label: '–ú–æ—Å–∫–æ–≤—Å–∫–∏–π –¥–æ–º —Å–æ–ª–¥–∞—Ç—Å–∫–æ–≥–æ —Å–µ—Ä–¥—Ü–∞', group: 'hub', pattern: 'nko' },
            { id: 'ARMY_CULT', label: '–ú–û–§ –ê—Ä–º–∏—è –∏ –∫—É–ª—å—Ç—É—Ä–∞', group: 'hub', pattern: 'nko' },

            // --- –ö–ê–ù–ê–õ 6: –¢–†–ê–ù–ó–ò–¢ –ò –û–ë–ù–ê–õ ---
            { id: 'RECORD', label: '–£–ö –†–µ–∫–æ—Ä–¥ –ö–∞–ø–∏—Ç–∞–ª', group: 'company', info: '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ç—å—é —Ç—Ä–∞–Ω–∑–∏—Ç–Ω—ã—Ö –ø—Ä–æ–∫–ª–∞–¥–æ–∫.', pattern: 'record' },
            { id: 'ANDREEV', label: '–ê–Ω–¥—Ä–µ–µ–≤ –Æ. –í.', group: 'person', info: '–ö—É—Ä–∞—Ç–æ—Ä —Å–µ—Ç–∏ –û—Ä–∏–æ–Ω, –ó–∞—Ä—è, –ö–∞—Å–∫–∞–¥.', pattern: 'record' },
            { id: 'IVANCH', label: '–ò–≤–∞–Ω—á–µ–Ω–∫–æ –ö. –ò.', group: 'person', info: '–ö—É—Ä–∞—Ç–æ—Ä —Å–µ—Ç–∏ –ú–µ—Ç—Ä–æ, –ï–≤—Ä–æ –°–µ—Ä–≤–∏—Å.', pattern: 'record' },
            { id: 'ORION', label: '–û–û–û –û—Ä–∏–æ–Ω', group: 'transit', pattern: 'record' },
            { id: 'ZARYA', label: '–û–û–û –ó–∞—Ä—è', group: 'transit', pattern: 'record' },
            { id: 'METRO', label: '–û–û–û –ú–µ—Ç—Ä–æ', group: 'transit', pattern: 'record' },
            { id: 'KASCAD', label: '–û–û–û –ö–∞—Å–∫–∞–¥', group: 'transit', pattern: 'record' },
            
            // –¢–†–ê–ù–ó–ò–¢–ù–´–ï –§–ò–ó–õ–ò–¶–ê (–î–†–û–ü–´)
            { id: 'TSAPINA', label: '–¶–∞–ø–∏–Ω–∞ –°. –í.', group: 'transit', info: '–¢—Ä–∞–Ω–∑–∏—Ç–µ—Ä (—Å—É–¥–µ–±–Ω—ã–µ –ø—Ä–∏–∫–∞–∑—ã –Ω–∞ –æ–±–Ω–∞–ª).', pattern: 'transit' },
            { id: 'LUEVA', label: '–õ—É–µ–≤–∞ –ò. –ü.', group: 'transit', pattern: 'transit' },
            { id: 'FROLOV', label: '–§—Ä–æ–ª–æ–≤ –õ. –ò.', group: 'transit', pattern: 'transit' },
            { id: 'SOLOMATINA', label: '–°–æ–ª–æ–º–∞—Ç–∏–Ω–∞ –¢. –ü.', group: 'person', info: '–ì–ª–∞–≤–±—É—Ö. –°–Ω—è—Ç–∏–µ –Ω–∞–ª–∏—á–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ –±–∞–Ω–∫–æ–º–∞—Ç—ã.', pattern: 'transit' },
            
            // –ò–ü
            { id: 'IP_BIT', label: '–ò–ü –ë–∏—Ç—é–∫–æ–≤ –ï.–ò.', group: 'transit', pattern: 'transit' },
            { id: 'IP_SUL', label: '–ò–ü –°—É–ª–∞–º–∞–Ω–∏–¥–∑–µ –ì.–î.', group: 'transit', pattern: 'transit' }
        ];

        const rawEdges = [
            { from: 'CH_L', to: 'SE2', label: '–ö–æ–Ω—Ç—Ä–æ–ª—å (85%)' },
            { from: 'SE2', to: 'EM', label: '–í—ã–≤–æ–¥ –≤—ã—Ä—É—á–∫–∏' },
            { from: 'BA_I', to: 'EM', label: '–ù–æ–º–∏–Ω–∞–ª' },
            { from: 'CH_A_P', to: 'EM', label: '–≠–∫—Å-–≤–ª–∞–¥–µ–ª–µ—Ü' },
            { from: 'SE2', to: 'MOBRAY', label: '–§–∏–∫—Ç–∏–≤–Ω—ã–π –∑–∞–µ–º' },
            { from: 'CH_A_P', to: 'MOBRAY', label: '–í–ª–∞–¥–µ–ª–µ—Ü 100%' },
            { from: 'SE2', to: 'FINWAY', label: '–§–∏–∫—Ç–∏–≤–Ω—ã–π –∑–∞–µ–º' },
            { from: 'KOL', to: 'FINWAY', label: '–¶–µ—Å—Å–∏—è' },
            { from: 'KHAR', to: 'SE2', label: '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ' },
            { from: 'KHAR', to: 'EM', label: '–ò—Å–∫ (42.1 –º–ª–Ω)' },
            { from: 'CH_L', to: 'PASS', label: '–£—á—Ä–µ–¥–∏—Ç–µ–ª—å' },
            { from: 'PASS', to: 'MEGAPIR', label: '–§–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ' },
            { from: 'BOGD', to: 'CHURCH', label: '–£—á—Ä–µ–¥–∏—Ç–µ–ª—å' },
            { from: 'ZAKH', to: 'CHURCH', label: '–£—á—Ä–µ–¥–∏—Ç–µ–ª—å' },
            { from: 'ZAKH', to: 'NPZ', label: '–ê–∫—Ü–∏–æ–Ω–µ—Ä' },
            { from: 'CH_L', to: 'NPZ', label: '–ê–∫—Ü–∏–æ–Ω–µ—Ä' },
            { from: 'CH_L', to: 'REV', label: '–£—á—Ä–µ–¥–∏—Ç–µ–ª—å' },
            { from: 'SE2', to: 'TSAPINA', label: '–°—É–¥–µ–±–Ω—ã–π –ø—Ä–∏–∫–∞–∑' },
            { from: 'SE2', to: 'SOLOMATINA', label: '–û–±–Ω–∞–ª' },
            { from: 'RECORD', to: 'ANDREEV', label: '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ' },
            { from: 'ANDREEV', to: 'ORION', label: '–ö–æ–Ω—Ç—Ä–æ–ª—å' },
            { from: 'ANDREEV', to: 'ZARYA', label: '–ö–æ–Ω—Ç—Ä–æ–ª—å' },
            { from: 'RECORD', to: 'IVANCH', label: '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ' },
            { from: 'IVANCH', to: 'METRO', label: '–ö–æ–Ω—Ç—Ä–æ–ª—å' }
        ];

        const nodes = new vis.DataSet(rawNodes);
        const edges = new vis.DataSet(rawEdges);

        const options = {
            nodes: {
                font: { size: 10, face: 'Inter', color: '#999' },
                borderWidth: 1.5,
                shadow: false
            },
            edges: {
                width: 0.8,
                color: { color: '#222', highlight: '#fff' },
                arrows: { to: { enabled: true, scaleFactor: 0.3 } },
                font: { size: 8, face: 'Inter', color: '#444', strokeWidth: 0 },
                smooth: { type: 'continuous' }
            },
            groups: {
                bankrupt: { color: { background: '#000', border: '#ff4d4d' }, shape: 'diamond', size: 16 },
                hub: { color: { background: '#000', border: '#7928ca' }, shape: 'star', size: 18 },
                official: { color: { background: '#000', border: '#0070f3' }, shape: 'star', size: 15 },
                company: { color: { background: '#000', border: '#444' }, shape: 'square', size: 12 },
                offshore: { color: { background: '#000', border: '#444' }, shape: 'square', size: 12 },
                person: { color: { background: '#000', border: '#444' }, shape: 'dot', size: 10 },
                transit: { color: { background: '#000', border: '#444' }, shape: 'dot', size: 8 }
            },
            physics: {
                forceAtlas2Based: { gravitationalConstant: -50, springLength: 150 },
                solver: 'forceAtlas2Based',
                stabilization: { iterations: 100 }
            },
            interaction: { hover: true }
        };

        const network = new vis.Network(document.getElementById('network-container'), { nodes, edges }, options);

        // –ü–æ–∏—Å–∫
        document.getElementById('node-search').addEventListener('input', (e) => {
            const val = e.target.value.toLowerCase();
            if (val.length < 2) return;
            const found = rawNodes.find(n => n.label.toLowerCase().includes(val) || (n.inn && n.inn.includes(val)));
            if (found) {
                network.focus(found.id, { scale: 1.4, animation: true });
                network.selectNodes([found.id]);
                showNodeInfo(found.id);
            }
        });

        function showNodeInfo(id) {
            const node = nodes.get(id);
            const sidebar = document.getElementById('info-sidebar');
            const header = document.getElementById('sidebar-header');
            const content = document.getElementById('info-content');

            header.innerHTML = `<h2 class="text-xs font-bold text-white uppercase tracking-widest">${node.label}</h2>
                                ${node.inn ? `<p class="text-[9px] text-zinc-600 mt-1 uppercase">–ò–ù–ù: ${node.inn}</p>` : ''}`;

            const connected = edges.get({ filter: e => e.from === id || e.to === id });
            const links = connected.map(e => {
                const other = nodes.get(e.from === id ? e.to : e.from);
                return `<div class="p-3 bg-zinc-950 border border-zinc-900 rounded mb-2 hover:border-zinc-700 cursor-pointer" onclick="focusOnNode('${other.id}')">
                    <p class="text-[8px] text-zinc-600 uppercase font-bold tracking-tighter">${e.label}</p>
                    <p class="text-[13px] text-zinc-300 mt-1">${other.label}</p>
                </div>`;
            }).join('');

            content.innerHTML = `
                <div class="mb-6 p-4 bg-zinc-950 border border-zinc-900 rounded-lg">
                    <p class="text-[10px] text-zinc-500 uppercase font-black mb-2 tracking-widest italic">–§–æ—Ä–µ–Ω–∑–∏–∫-—Å–ø—Ä–∞–≤–∫–∞</p>
                    <p class="text-xs text-zinc-400 leading-relaxed font-light">${node.info || '–û–±—ä–µ–∫—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –≤ —Ö–æ–¥–µ –∞–Ω–∞–ª–∏–∑–∞ –∞—Ñ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏.'}</p>
                </div>
                <h3 class="text-[9px] text-zinc-600 uppercase font-black mb-4 tracking-widest">–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å–≤—è–∑–∏</h3>
                <div>${links || '<p class="text-zinc-700 text-xs">–ü—Ä—è–º—ã–µ —Å–≤—è–∑–∏ –≤ —Ç–µ–∫—É—â–µ–º —Å–ª–æ–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.</p>'}</div>
            `;
            sidebar.classList.remove('hidden');
        }

        function applyFilter(type) {
            closeSidebar();
            const report = document.getElementById('analytic-report');
            const title = document.getElementById('report-title');
            const text = document.getElementById('report-text');
            const list = document.getElementById('report-nodes');

            report.classList.remove('hidden');
            const targetNodes = rawNodes.filter(n => n.pattern === type || n.id === 'SE2');
            
            nodes.update(rawNodes.map(n => ({
                id: n.id,
                opacity: targetNodes.some(tn => tn.id === n.id) ? 1 : 0.05,
                font: { color: targetNodes.some(tn => tn.id === n.id) ? '#fff' : 'transparent' }
            })));

            if (type === 'profit') {
                title.innerText = '–ö–∞–Ω–∞–ª 1: –ó–∞—Ö–≤–∞—Ç –≤—ã—Ä—É—á–∫–∏';
                text.innerText = '–°—Ö–µ–º–∞ –∞–∫–∫—É–º—É–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏–±—ã–ª–∏ —Å–∞–Ω–∞—Ç–æ—Ä–∏—è –Ω–∞ –û–û–û –≠–ª—å—Ç–æ–Ω-–ú–µ–¥ –∏ –û–û–û –ö–æ–Ω—Ñ–µ—Ç—Ç–∏.';
            } else if (type === 'offshore') {
                title.innerText = '–ö–∞–Ω–∞–ª 2: –û—Ñ—à–æ—Ä–Ω–∞—è —Å–µ—Ç—å';
                text.innerText = '–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ñ–∏–∫—Ç–∏–≤–Ω–æ–π –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥ –ö–∏–ø—Ä–æ–º –∏ –ì–æ–Ω–∫–æ–Ω–≥–æ–º –¥–ª—è –≤—ã–≤–æ–¥–∞ –≤–∞–ª—é—Ç—ã.';
            } else if (type === 'empire') {
                title.innerText = '–ö–∞–Ω–∞–ª 3: –ò–º–ø–µ—Ä–∏—è –ß—É–≥—É–Ω–æ–≤–∞';
                text.innerText = '–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –∫–∞–ø–∏—Ç–∞–ª–∞ –≤ —Ç–≤–µ—Ä–¥—ã—Ö –∞–∫—Ç–∏–≤–∞—Ö: –ù–ü–ó, –ï–≤—Ä–æ–º–µ–¥—Å–µ—Ä–≤–∏—Å, –ò—Å—Ç—å–∏–Ω—Å–∫–∞—è —Ä–µ–≤—å–µ—Ä–∞.';
            } else if (type === 'nko') {
                title.innerText = '–ö–∞–Ω–∞–ª 4-5: –ù–ö–û –∏ –•–∞–±—ã';
                text.innerText = '–°–∫—Ä—ã—Ç–∏–µ –∞–∫—Ç–∏–≤–æ–≤ –≤ —Ñ–æ–Ω–¥–∞—Ö –ú–µ–≥–∞–ø–∏—Ä –∏ —Ä–µ–ª–∏–≥–∏–æ–∑–Ω—ã—Ö –ø—Ä–∏—Ö–æ–¥–∞—Ö –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –≤–∑—ã—Å–∫–∞–Ω–∏—è.';
            } else if (type === 'transit') {
                title.innerText = '–ö–∞–Ω–∞–ª 6: –û–±–Ω–∞–ª –∏ —Ç—Ä–∞–Ω–∑–∏—Ç';
                text.innerText = '–í—ã–≤–æ–¥ –Ω–∞–ª–∏—á–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ —Å—É–¥–µ–±–Ω—ã–µ –ø—Ä–∏–∫–∞–∑—ã –∏ —Ñ–∏–∑–ª–∏—Ü-–¥—Ä–æ–ø–æ–≤ (–¶–∞–ø–∏–Ω–∞, –õ—É–µ–≤–∞ –∏ –¥—Ä).';
            } else if (type === 'record') {
                title.innerText = '–£–ö –†–µ–∫–æ—Ä–¥ –ö–∞–ø–∏—Ç–∞–ª';
                text.innerText = '–°–µ—Ç–µ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º–∏ –∫–æ–º–ø–∞–Ω–∏—è–º–∏-–ø—Ä–æ–∫–ª–∞–¥–∫–∞–º–∏.';
            }

            list.innerHTML = targetNodes.filter(n => n.id !== 'SE2').map(n => `
                <div class="p-2.5 bg-zinc-900 border border-zinc-800 rounded text-[11px] text-zinc-300 hover:text-white cursor-pointer" onclick="focusOnNode('${n.id}')">
                    ${n.label}
                </div>
            `).join('');

            network.fit({ nodes: targetNodes.map(n => n.id), animation: true });
        }

        function focusOnNode(id) {
            network.focus(id, { scale: 1.4, animation: true });
            network.selectNodes([id]);
            showNodeInfo(id);
        }

        function resetView() {
            nodes.update(rawNodes.map(n => ({ id: n.id, opacity: 1, font: { color: '#999' } })));
            closeReport(); closeSidebar();
            network.fit({ animation: true });
        }

        function closeSidebar() { document.getElementById('info-sidebar').classList.add('hidden'); }
        function closeReport() { document.getElementById('analytic-report').classList.add('hidden'); }

        network.on("click", e => e.nodes.length > 0 ? showNodeInfo(e.nodes[0]) : resetView());
    </script>
</body>
</html>
